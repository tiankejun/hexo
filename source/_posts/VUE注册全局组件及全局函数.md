---
title: VUE组册全局组件以及全局函数
date: 2018-05-16 23:32
tags: VUE公共组件
toc: true
---
### 需求
根据公司需求，需要结合XX公司提供的地图包，开发一款可以直接使用的vue标签，用法与element UI相似，在组件内直接使用不用在此引用

### 工程搭建
#### 1、初始化工程
```
vue init webpack riemann-map
```
后面根据提示一步一步输入即可，完成后
输入 ```tree /F ``` 目录结构如下:
```
E:.
│ package.json
│ ...               // 其他文件
│
├─build             // webpack 打包配置
├─config            // webpack 配置目录
├─node_modules      // 存放第三方依赖模块
├─src
│  ├─components    //公共业务模块
│  │  App.vue       //主要用于测试自己开发的子模块
│  │  main.js       //创建vue 实例对象
│  │
│  └─assets         //暂无用
│     logo.png
│
├─static            //静态资源
│      .gitkeep
│
└─test              //测试
    ├─e2e
    │   ...
    ├─unit
    │   ...
```
#### 2、修改工程目录 
```
│ package.json
│ ...               // 其他文件
│
├─build             // webpack 打包配置
├─config            // webpack 配置目录
├─node_modules      // 存放第三方依赖模块
│   ...                 
├─packages          // 存放业务模块
│   ...
├─src
│  │  App.vue       //主要用于测试自己开发的子模块
│  │  index.js      //导出所有 vue 组件
│  │  main.js       //创建vue 实例对象
│  │
│  └─assets         //暂无用
│     logo.png
│
├─static            //静态资源
│      .gitkeep
│
└─test              //测试
    ├─e2e
    │   ...
    ├─unit
    │   ...
```
与刚开始的目录区别主要在于   
>1、去掉 1 中的 src下 components 这个目录  
2、在 2 中 src 同级目录下添加 packages 目录，并且在src 下 新增 index.js文件用于导出所有模块的

### 编写业务逻辑
#### 1、创建子模块目录
在 packages 目录下新建一个目录，此处新建的目录代表一个模块， 如：
```
├─packages          // 存放业务模块
│  └─baseMap        // 子模块
│      │  index.js  // 导出 vue 组件
│      │
│      └─src        // 子模块 vue 业务逻辑
│         main.vue
```
#### 2、编写业务逻辑
2.1、main.vue 如下
```
<template>
  <div>
    <h1>{{testWords}}</h1>
  </div>
</template>
<script>
export default{
  name: 'BaseMap',
  data() {
    return {
      testWords: 'Hello worlds'
    }
  },
  methods: {

  }
}
</script>
<style>
</style>

```
2.2、index.js 如下
```
import BaseMap from './src/main';
/* istanbul ignore next */
BaseMap.install = function(Vue) {
  Vue.component(BaseMap.name, BaseMap);
};

export default BaseMap;

```
### 将所有子组件实例化，并导出一个对象
src下面的index.js 如下
```
// 全局函数
import Log from './log'

/* Automatically generated by './build/bin/build-entry.js' */
import BaseMap from '../packages/baseMap/index.js';
const components = [
    BaseMap
];
const install = function(Vue, opts = {}) {
    //循环实例VUE化组件
    components.map(component => {
        Vue.component(component.name, component);
    });
    // 全局方法
    Vue.log = Vue.prototype.$log = Log
    // 使用如下： this.$log.funName
};
/* istanbul ignore if */
if (typeof window !== 'undefined' && window.Vue) {
    install(window.Vue);
};
//导出组件
export default {
    version: '0.1.0',
    install,
    BaseMap
};

```
### 测试
main.js 引入组件，并通过全局方法 Vue.use() 使用插件
```
import Vue from 'vue'
import App from './App'
import MAP from './index.js'    //引入组件
Vue.use(MAP)    //使用组件

Vue.config.productionTip = false

/* eslint-disable no-new */
new Vue({
  el: '#app',
  components: { App },
  template: '<App/>'
})

```

App.vue 添加组件
```
<template>
  <div id="app">
    <!--引入组件-->
    <base-map></base-map>
  </div>
</template>

<script>
export default {
  name: 'App',
  data() {
    return {

    }
  },
  methods: {

  }
}
</script>

<style>
#app {
  font-family: 'Avenir', Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  margin-top: 60px;
}
</style>

```

### 结束
如果页面出现出现 ```Hello worlds ``` 则创建组件完成
